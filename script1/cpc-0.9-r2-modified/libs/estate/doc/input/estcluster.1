.\"
estcluster \- graph theory based EST clustering program.
.SH SYNOPSIS
.B estcluster
[ -hvc ] [ -dARsCTtaHOEbjor ]
<fasta database path> <allvsall score file>
.SH DESCRIPTION
.BR estcluster
uses the a graph theoretic approach to allow rapid
generation of high quality EST clusters.

Word scores are used from the
.B estcluster (1)
program to prioritise alignments to detect significant overlaps
using dynamic programming.

An anytime exit is allowed, maintaining independency
of the input order of the original sequences.
.RE
.SH OPTIONS
.\"
.TP
.BI "\-d \--database " sequence-database
Specify the FASTA format input file.  This should be the same
file as was used with
.B precluster (1)
.\"
.TP
.BI "\-A \--allvsall " allvsall-results-path
This should be the all-vs-all results file generated by
.B precluster (1)
.\"
.TP
.BI "\-R \--allvsallrc " revcomp-results-path
This should be the all-vs-all results file generated by
.B precluster (1)
.\"
.TP
.BI "\-m \--submat " substitution-matrix
This is a path to a substitution matrix, to be used for the
dynamic programming.  The default is
.I "nucleic"
which is an alias to specify the use of a built in substitution
matrix for nucleotides.
.\"
.TP
.BI "\-C \--anytimecount " anytime-exit-threshold
This number is used in conjuntion with the --historycount (see below)
to specify the behaviour of the anytime exit.

When there are fewer than this number of hits above the threshold
in the history, the program report the results and exit.
.\"
.TP
.BI "\-T \--historycount " history-size
This specifies the minimum number of scores required in the
history before an anytime exit is permitted.  The number of
results kept in the history may be slightly more, to maintain
independency from the input order of the sequences.

If a value of zero is given the program will not exit
until all candidate pairs of sequences with matching words
have been used to try and join clusters by alignment.
This will take a very long time, but guarantee the best result.
.\"
.TP
.BI "\-t \--thinkaloud " boolean
This will print information for analysis and debugging.
.\"
.TP
.BI "\-a \--showalignments " boolean
This will show the alignments for pairs of sequences scoreing
above the threshold specified by
.I --jointhreshold
(see below)

This can be useful in selecting appropriate parameters,
as it is possible to view the parameters which are being used
to join clusters.

.B *** WARNING ***

This option has not been fully implemented for the
current version, and will display
.I global
alignments instead of the
.I overlap
alignments being used to generate the scores.
This means that the alignments displayed in many cases
are pretty meaninless, although the results of the clustering
are unaffected.  This will be fixed soon.
.\"
.TP
.BI "\-H \--showhistogram " boolean
As a default, a histogram of cluster sizes will be displayed
periodically as the clusters form.  This can be used to check
that sensible parameters have been selected, and to monitor
the progress of the clustering.  This option allows you to
supress display of the histogram during the clustering.
.\"
.TP
.BI "\-O \--gapopen " gapopen-penalty
This is the gap open penalty used for generating the overlap
alignments.
.\"
.TP
.BI "\-E \--gapextend " gapextend-penalty
This is the gap extend penalty used for generating the overlap
alignments.
.\"
.TP
.BI "\-i \--reportonbreak " boolean
By default,
.B estcluster (1)
will trap the first SIGINT, which will schedule an anytime exit
for the next point when it can be achieved maintaining independency
from input order.

This can easily be done by pressing [CTRL]-C in
the terminal in which it is running.  This option allows you
to disable this feature.
.\"
.TP
.BI "\-j \--jointhreshold " clustering-joining-threshold
This specifies the minimum overlap alignment score required
for single linkage of two clusterings.
.\"
.TP
.BI "\-o \--outputdir " output-directory-path
This specifies a directory into which the clusters will be
written.  Existing data will not be overwritten.  If no path
is given, no output will be written.
.\"
.SH EXAMPLES
.\"
.B "estcluster -d lib01.fasta -A lib01.avafw -R lib01.avarc"
.RS
This will run estcluster using the defaults, using the sequences
in lib01.fasta and the score files, lib01.avafw and lib01.avarc.
These can be generated using the program
.I precluster (1)
.RE
.\"
